import{K as y,N as w,O as E,Q as M,V as de,W as D,X as fe,Y as K,Z as me,_ as L,$ as pe,a0 as ye,r as N,a1 as ge,a2 as V,a3 as he,a4 as X,a5 as ve,a6 as xe,j as s,a7 as be,a8 as je,a9 as Pe,G as Oe,I as Ae,aa as Y,B as we,x as _e,ab as Ne,C as B,a as q,b as W,ac as Ee,c as z,ad as Re,w as k}from"./index-B-k02BhT.js";import{u as T}from"./useQuery-DIgGmLU4.js";import{P as Se,a as ne,b as ae}from"./PolarAngleAxis-CkfBKpJj.js";var Ce=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function R(t){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(t)}function $e(t,e){if(t==null)return{};var r=De(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function De(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function P(){return P=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},P.apply(this,arguments)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Z(Object(r),!0).forEach(function(n){Le(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Le(t,e,r){return e=ke(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ke(t){var e=Te(t,"string");return R(e)=="symbol"?e:e+""}function Te(t,e){if(R(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(R(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Me=function(e,r,n,a){var i="";return a.forEach(function(c,l){var o=E(r,n,e,c);l?i+="L ".concat(o.x,",").concat(o.y):i+="M ".concat(o.x,",").concat(o.y)}),i+="Z",i},Fe=function(e){var r=e.cx,n=e.cy,a=e.innerRadius,i=e.outerRadius,c=e.polarAngles,l=e.radialLines;if(!c||!c.length||!l)return null;var o=S({stroke:"#ccc"},w(e,!1));return y.createElement("g",{className:"recharts-polar-grid-angle"},c.map(function(u){var d=E(r,n,a,u),f=E(r,n,i,u);return y.createElement("line",P({},o,{key:"line-".concat(u),x1:d.x,y1:d.y,x2:f.x,y2:f.y}))}))},Ie=function(e){var r=e.cx,n=e.cy,a=e.radius,i=e.index,c=S(S({stroke:"#ccc"},w(e,!1)),{},{fill:"none"});return y.createElement("circle",P({},c,{className:M("recharts-polar-grid-concentric-circle",e.className),key:"circle-".concat(i),cx:r,cy:n,r:a}))},Ke=function(e){var r=e.radius,n=e.index,a=S(S({stroke:"#ccc"},w(e,!1)),{},{fill:"none"});return y.createElement("path",P({},a,{className:M("recharts-polar-grid-concentric-polygon",e.className),key:"path-".concat(n),d:Me(r,e.cx,e.cy,e.polarAngles)}))},Be=function(e){var r=e.polarRadius,n=e.gridType;return!r||!r.length?null:y.createElement("g",{className:"recharts-polar-grid-concentric"},r.map(function(a,i){var c=i;return n==="circle"?y.createElement(Ie,P({key:c},e,{radius:a,index:i})):y.createElement(Ke,P({key:c},e,{radius:a,index:i}))}))},ie=function(e){var r=e.cx,n=r===void 0?0:r,a=e.cy,i=a===void 0?0:a,c=e.innerRadius,l=c===void 0?0:c,o=e.outerRadius,u=o===void 0?0:o,d=e.gridType,f=d===void 0?"polygon":d,p=e.radialLines,g=p===void 0?!0:p,x=$e(e,Ce);return u<=0?null:y.createElement("g",{className:"recharts-polar-grid"},y.createElement(Fe,P({cx:n,cy:i,innerRadius:l,outerRadius:u,gridType:f,radialLines:g},x)),y.createElement(Be,P({cx:n,cy:i,innerRadius:l,outerRadius:u,gridType:f,radialLines:g},x)))};ie.displayName="PolarGrid";var G,J;function qe(){if(J)return G;J=1;function t(e){return e&&e.length?e[0]:void 0}return G=t,G}var H,U;function We(){return U||(U=1,H=qe()),H}var ze=We();const Ge=de(ze);var He=["key"];function _(t){"@babel/helpers - typeof";return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(t)}function Qe(t,e){if(t==null)return{};var r=Ve(t,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ve(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function F(){return F=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},F.apply(this,arguments)}function ee(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ee(Object(r),!0).forEach(function(n){j(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,se(n.key),n)}}function Ye(t,e,r){return e&&te(t.prototype,e),r&&te(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ze(t,e,r){return e=I(e),Je(t,oe()?Reflect.construct(e,r||[],I(t).constructor):e.apply(t,r))}function Je(t,e){if(e&&(_(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ue(t)}function Ue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oe=function(){return!!t})()}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},I(t)}function et(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Q(t,e)}function j(t,e,r){return e=se(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function se(t){var e=tt(t,"string");return _(e)=="symbol"?e:e+""}function tt(t,e){if(_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var C=(function(t){function e(){var r;Xe(this,e);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Ze(this,e,[].concat(a)),j(r,"state",{isAnimationFinished:!1}),j(r,"handleAnimationEnd",function(){var c=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),D(c)&&c()}),j(r,"handleAnimationStart",function(){var c=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),D(c)&&c()}),j(r,"handleMouseEnter",function(c){var l=r.props.onMouseEnter;l&&l(r.props,c)}),j(r,"handleMouseLeave",function(c){var l=r.props.onMouseLeave;l&&l(r.props,c)}),r}return et(e,t),Ye(e,[{key:"renderDots",value:function(n){var a=this.props,i=a.dot,c=a.dataKey,l=w(this.props,!1),o=w(i,!0),u=n.map(function(d,f){var p=v(v(v({key:"dot-".concat(f),r:3},l),o),{},{dataKey:c,cx:d.x,cy:d.y,index:f,payload:d});return e.renderDotItem(i,p)});return y.createElement(K,{className:"recharts-radar-dots"},u)}},{key:"renderPolygonStatically",value:function(n){var a=this.props,i=a.shape,c=a.dot,l=a.isRange,o=a.baseLinePoints,u=a.connectNulls,d;return y.isValidElement(i)?d=y.cloneElement(i,v(v({},this.props),{},{points:n})):D(i)?d=i(v(v({},this.props),{},{points:n})):d=y.createElement(Se,F({},w(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:n,baseLinePoints:l?o:null,connectNulls:u})),y.createElement(K,{className:"recharts-radar-polygon"},d,c?this.renderDots(n):null)}},{key:"renderPolygonWithAnimation",value:function(){var n=this,a=this.props,i=a.points,c=a.isAnimationActive,l=a.animationBegin,o=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state.prevPoints;return y.createElement(me,{begin:l,duration:o,isActive:c,easing:u,from:{t:0},to:{t:1},key:"radar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var g=p.t,x=f&&f.length/i.length,m=i.map(function(h,O){var b=f&&f[Math.floor(O*x)];if(b){var $=L(b.x,h.x),ce=L(b.y,h.y);return v(v({},h),{},{x:$(g),y:ce(g)})}var le=L(h.cx,h.x),ue=L(h.cy,h.y);return v(v({},h),{},{x:le(g),y:ue(g)})});return n.renderPolygonStatically(m)})}},{key:"renderPolygon",value:function(){var n=this.props,a=n.points,i=n.isAnimationActive,c=n.isRange,l=this.state.prevPoints;return i&&a&&a.length&&!c&&(!l||!pe(l,a))?this.renderPolygonWithAnimation():this.renderPolygonStatically(a)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.className,c=n.points,l=n.isAnimationActive;if(a||!c||!c.length)return null;var o=this.state.isAnimationFinished,u=M("recharts-radar",i);return y.createElement(K,{className:u},this.renderPolygon(),(!l||o)&&ye.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"renderDotItem",value:function(n,a){var i;if(y.isValidElement(n))i=y.cloneElement(n,a);else if(D(n))i=n(a);else{var c=a.key,l=Qe(a,He);i=y.createElement(fe,F({},l,{key:c,className:M("recharts-radar-dot",typeof n!="boolean"?n.className:"")}))}return i}}])})(N.PureComponent);j(C,"displayName","Radar");j(C,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!ge.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});j(C,"getComposedData",function(t){var e=t.radiusAxis,r=t.angleAxis,n=t.displayedData,a=t.dataKey,i=t.bandSize,c=r.cx,l=r.cy,o=!1,u=[],d=r.type!=="number"?i??0:0;n.forEach(function(p,g){var x=V(p,r.dataKey,g),m=V(p,a),h=r.scale(x)+d,O=Array.isArray(m)?he(m):m,b=X(O)?void 0:e.scale(O);Array.isArray(m)&&m.length>=2&&(o=!0),u.push(v(v({},E(c,l,b,h)),{},{name:x,value:m,cx:c,cy:l,radius:b,angle:h,payload:p}))});var f=[];return o&&u.forEach(function(p){if(Array.isArray(p.value)){var g=Ge(p.value),x=X(g)?void 0:e.scale(g);f.push(v(v({},p),{},{radius:x},E(c,l,x,p.angle)))}else f.push(p)}),{points:u,isRange:o,baseLinePoints:f}});var rt=ve({chartName:"RadarChart",GraphicalChild:C,axisComponents:[{axisType:"angleAxis",AxisComp:ne},{axisType:"radiusAxis",AxisComp:ae}],formatAxisMap:xe,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function A(t,e,r){return Math.round(t+(e-t)*r)}function nt(t){const e=Math.max(-1,Math.min(1,t)),r=[239,68,68],n=[255,255,255],a=[34,197,94];let i,c,l;if(e<0){const o=(e+1)/1;i=A(r[0],n[0],o),c=A(r[1],n[1],o),l=A(r[2],n[2],o)}else{const o=e;i=A(n[0],a[0],o),c=A(n[1],a[1],o),l=A(n[2],a[2],o)}return`rgb(${i}, ${c}, ${l})`}const at=({labels:t,matrix:e,size:r=32})=>{const n=t.length,a=r*(n+1),i=r*(n+1);return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("svg",{width:a,height:i,className:"rounded-lg ring-1 ring-border bg-card",children:[t.map((c,l)=>s.jsx("text",{x:(l+1)*r+r/2,y:r/2,textAnchor:"middle",fontSize:11,fill:"#6b7280",children:c},`t-${l}`)),t.map((c,l)=>s.jsx("text",{x:r/2,y:(l+1)*r+r/2,textAnchor:"middle",fontSize:11,fill:"#6b7280",children:c},`l-${l}`)),e.map((c,l)=>c.map((o,u)=>{const d=(u+1)*r,f=(l+1)*r,p=typeof o=="number"&&Number.isFinite(o)?o:0,g=nt(p);return s.jsxs("g",{children:[s.jsx("rect",{x:d,y:f,width:r-2,height:r-2,fill:g,rx:4}),s.jsx("text",{x:d+(r-2)/2,y:f+(r-2)/2+4,textAnchor:"middle",fontSize:11,fill:"#111827",children:p.toFixed(2)})]},`c-${l}-${u}`)}))]})})},re={goals:"Scoring",home_adv:"Home Adv",balance:"Balance",predictability:"Predictability",physicality:"Physicality"},it=({data:t})=>{const r=Object.keys(re).map(a=>{const i={metric:re[a]};return t.forEach(c=>{i[c.leagueName]=c.metrics[a]}),i}),n=["#3b82f6","#22c55e","#f59e0b","#ef4444","#8b5cf6"];return s.jsx("div",{className:"w-full h-[380px]",children:s.jsx(be,{children:s.jsxs(rt,{data:r,outerRadius:110,children:[s.jsx(ie,{}),s.jsx(ne,{dataKey:"metric",tick:{fill:"#6b7280",fontSize:11}}),s.jsx(ae,{angle:30,domain:[0,100],tick:{fill:"#9ca3af",fontSize:10}}),t.map((a,i)=>s.jsx(C,{name:a.leagueName,dataKey:a.leagueName,stroke:n[i%n.length],fill:n[i%n.length],fillOpacity:.25},a.leagueId)),s.jsx(je,{}),s.jsx(Pe,{})]})})})},lt=()=>{const[t,e]=N.useState([]),r=T({queryKey:["leagues-list"],queryFn:async()=>{const{data:o,error:u}=await k.from("leagues").select("id, name");if(u)throw u;return o??[]}});N.useEffect(()=>{r.data&&r.data.length>0&&t.length===0&&e(r.data.slice(0,2).map(o=>o.id))},[r.data,t.length]);const n=T({queryKey:["cross-league-analyze",t],enabled:t.length>0,queryFn:async()=>{const{data:o,error:u}=await k.functions.invoke("cross-league-analyze",{body:{league_ids:t,metrics:["goals","home_adv","balance","predictability","physicality"]}});if(u)throw u;return o}}),a=T({queryKey:["correlations-heatmap"],queryFn:async()=>{const{data:o,error:u}=await k.functions.invoke("cross-league-correlations",{body:{}});if(u)throw u;return o}}),i=T({queryKey:["meta-patterns-discover"],queryFn:async()=>{const{data:o,error:u}=await k.functions.invoke("meta-patterns-discover",{body:{}});if(u)throw u;return o}}),c=N.useMemo(()=>!n.data?.leagues||!n.data?.metrics?[]:n.data.leagues.map(o=>({leagueId:o.id,leagueName:o.name,metrics:n.data.metrics[o.id]??{goals:0,home_adv:0,balance:0,predictability:0,physicality:0}})),[n.data]),l=N.useMemo(()=>{const o=a.data?.leagues??[],u=o.map(m=>m.name),d=o.length,f=Array.from({length:d},()=>Array.from({length:d},()=>0)),p=a.data?.correlations??[],g=(m,h)=>`${m}|${h}`,x=new Map;for(const m of p)m.correlation_type==="scoring_trend"&&(x.set(g(m.league_a_id,m.league_b_id),m.coefficient??0),x.set(g(m.league_b_id,m.league_a_id),m.coefficient??0));return o.forEach((m,h)=>{o.forEach((O,b)=>{if(h===b){f[h][b]=1;return}const $=x.get(g(m.id,O.id));f[h][b]=typeof $=="number"?$:0})}),{labels:u,matrix:f}},[a.data]);return s.jsxs("div",{className:"min-h-screen",children:[s.jsx(Oe,{}),s.jsx(Ae,{}),s.jsx("main",{className:"ml-0 md:ml-[84px] py-10 sm:py-14",children:s.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full ring-1 ring-primary/20 bg-primary/10 px-2.5 py-1 mb-2",children:[s.jsx(Y,{className:"w-3.5 h-3.5 text-primary"}),s.jsx("span",{className:"text-[11px] text-primary font-semibold",children:"Cross-League Intelligence"})]}),s.jsx("h1",{className:"text-2xl sm:text-3xl tracking-tight text-foreground font-semibold",children:"Liga-közi elemzés"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Korrelációk, meta-patternök és liga-normalizált metrikák."})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:"Kiválasztott ligák:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:(r.data??[]).map(o=>s.jsx(we,{onClick:()=>e(u=>u.includes(o.id)?u.filter(d=>d!==o.id):[...u,o.id]),className:`${t.includes(o.id)?"bg-primary text-primary-foreground":"bg-muted text-foreground"} cursor-pointer`,children:o.name},o.id))}),s.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>n.refetch(),className:"ml-auto",children:[s.jsx(Ne,{className:"w-4 h-4 mr-2"})," Frissítés"]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(B,{children:[s.jsx(q,{children:s.jsxs(W,{className:"flex items-center gap-2",children:[s.jsx(Ee,{className:"w-4 h-4"})," LeagueComparisonRadarChart"]})}),s.jsx(z,{children:s.jsx(it,{data:c})})]}),s.jsxs(B,{children:[s.jsx(q,{children:s.jsxs(W,{className:"flex items-center gap-2",children:[s.jsx(Y,{className:"w-4 h-4"})," CorrelationHeatmap (scoring_trend)"]})}),s.jsx(z,{children:s.jsx(at,{labels:l.labels??[],matrix:l.matrix??[]})})]})]}),s.jsxs(B,{children:[s.jsx(q,{children:s.jsxs(W,{className:"flex items-center gap-2",children:[s.jsx(Re,{className:"w-4 h-4"})," Meta-patternök"]})}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(i.data?.meta_patterns??[]).map(o=>s.jsxs("div",{className:"p-4 rounded-lg ring-1 ring-border bg-card",children:[s.jsx("div",{className:"font-semibold",children:o.pattern_name}),s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Típus: ",o.pattern_type," • Evidence: ",o.evidence_strength,"%"]}),s.jsx("div",{className:"text-sm mt-2",children:o.pattern_description})]},`${o.pattern_name}-${o.pattern_type}`)),(!i.data?.meta_patterns||i.data.meta_patterns.length===0)&&s.jsx("div",{className:"text-sm text-muted-foreground",children:"Nincs elég adat meta-patternök azonosításához."})]})})]})]})})]})};export{lt as default};
